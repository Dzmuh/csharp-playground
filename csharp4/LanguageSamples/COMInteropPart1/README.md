# Образец COM-взаимодействия, часть 1

Данный образец демонстрирует способ взаимодействия программы на языке C# с неуправляемым COM-компонентом.

### Примечание по безопасности

Данный образец кода предоставлен для иллюстрирования концепции и не должен использоваться в приложениях или веб-сайтах, так как он не демонстрирует опыт написания безопасного кода. Корпорация Майкрософт не несет ответственность за случайный или косвенный ущерб, который может быть вызван использованием кода примера не по назначению.

Примечание. Если параметр nopia включен, создать новый компонентный класс COM нельзя.

## Построение и запуск образцов COM-взаимодействия (часть 1) в Visual Studio

1. В обозревателе решений щелкните правой кнопкой мыши проект Interop1 и выберите пункт Назначить запускаемым проектом.
2. В обозревателе решений щелкните правой кнопкой мыши проект Interop1 и выберите пункт Свойства.
3. Откройте папку «Свойства конфигурации» и выберите пункт Отладка.
4. В поле свойства «Аргументы командной строки» введите AVI-файл, например c:\winnt\clock.avi.
5. Нажмите кнопку ОК.
6. В меню Отладка выберите команду Запуск без отладки.
7. Повторите предыдущие шаги для Interop2.

## Если библиотека QuartzTypeLib.dll, включенная в Interop1, устарела

1. В обозревателе решений откройте пункт Ссылки для Interop1.
2. Щелкните правой кнопкой мыши пункт QuartzTypeLib, а затем выберите команду Удалить.
3. Щелкните правой кнопкой мыши пункт Ссылки и выберите команду Добавить ссылку.
4. На вкладке COM выберите компонент с именем «Библиотека типов элементов управления ActiveMovie».
5. Нажмите кнопку Выбрать, а затем кнопку OK.
6. Выполните повторное построение Interop1.
  
**Примечание**\
Добавление ссылки на компонент аналогично вызову tlbimp в командной строке с целью создания библиотеки QuartzTypeLib.dll (как показано ниже).

## Построение и запуск образцов COM-взаимодействия (часть 1) из командной строки

1. Для перехода к каталогу Interop1 используйте команду Сменить каталог.
2. Введите следующие данные:
  ```
tlbimp %windir%\system32\quartz.dll /out:QuartzTypeLib.dll
csc /l:QuartzTypeLib.dll interop1.cs 
interop1 %windir%\clock.avi
```
3. Для перехода к каталогу Interop2 используйте команду Сменить каталог.
4. Введите следующие данные:
  ```
    csc interop2.cs
    interop2 %windir%\clock.avi
```

Примечание. Если параметр nopia включен, создать новый компонентный класс COM нельзя.
